<!DOCTYPE html>
<html>
<head>
    <title>Let's Chat Web-App</title>
    <link rel = "icon" href = "Screenshot 2020-11-10 174637.png" 
        type = "image/x-icon">
<script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/live/3.1/firebase.js"></script>

<link href="https://fonts.googleapis.com/css?family=Yeon+Sung&display=swap" rel="stylesheet"><meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

<link rel="stylesheet" type="text/css" href="style.css">

</head>
<body>
<div class="container">
<button onclick="logout();" id="logout" class="glyphicon glyphicon-log-out btn btn-danger">Logout</button>
	<center>
		<h1 class="header">	
			Let's Chat Web-App	
			<sup>
				<img src="Screenshot 2020-11-10 174322.png">
            </sup>
        </h1>
            <h3 id="Username" style="color:darkblue"></h3>
		<div class="form-group input_div_room_page">
            <label style="color: white !important;">Group Code:</label>
            <input type="text" id="group_code" class="form-control" placeholder="Group ID">
		</div>
		<button onclick="addGroup();" class="btn btn-success">Add Group</button>
        <h3 class="color_white">Live chat - comments</h3>
        
        <div id="output"></div>
	
	</center>
</div>
<script>
    user = localStorage.getItem("User Name");
    Group_names = "";

    document.getElementById("Username").innerHTML = "<i>" + "Welcome " + user + "!" + "</i>";

    var firebaseConfig = {
    apiKey: "AIzaSyAcJXq3UUaofQbwWgD3Hm6wNu9gextHIR0",
    authDomain: "live-chat---web-app.firebaseapp.com",
    databaseURL: "https://live-chat---web-app.firebaseio.com",
    projectId: "live-chat---web-app",
    storageBucket: "live-chat---web-app.appspot.com",
    messagingSenderId: "814418449526",
    appId: "1:814418449526:web:b007d0c22cf5a5e6723b57",
    measurementId: "G-5MQZFLY7V2"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);

function addGroup(){
    Group_names = document.getElementById("group_code").value;
    localStorage.setItem("New Group", Group_names);
    firebase.database().ref("/").child(Group_names).update({                                                 
			purpose : "adding group"
        });
    
}

function addRoom(){
    Group_names = document.getElementById("group_code").value;

    firebase.database().ref("/").child(Group_names).update({                                                 
			purpose : "adding group name"
        });

    localStorage.setItem("New Group", Group_names);

    window.location = "room.html";                                                
}


function getData() {
    firebase.database().ref("/").on('value', function(snapshot){
        document.getElementById("output").innerHTML = "";
    snapshot.forEach(function(childSnapshot){
        childKey  = childSnapshot.key;
      Group_names = childKey;
      //Start code
      console.log("Group Name - " + Group_names);
      row = "<div class='room_name' id=" + Group_names + " onclick='redirectToRoomName(this.id)'>#" + Group_names +"</div><hr>";
      document.getElementById("output").innerHTML += row;
      //End code
      });});}
getData();

function redirectToRoomName(name){
    console.log(name);
    
    localStorage.setItem("Group Name", name);
    window.location = "room.html";                                             
}

function logout(){
    window.location = "index.html";
}

</script>
</body>
</html>